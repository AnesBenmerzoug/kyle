Search.setIndex({docnames:["calibration_demo","fake_classifiers","getting-started","index","kyle/calibration","kyle/calibration/calibration_methods","kyle/calibration/calibration_methods/calibration_methods","kyle/calibration/model_calibrator","kyle/datasets","kyle/evaluation","kyle/evaluation/continuous","kyle/evaluation/discrete","kyle/index","kyle/integrals","kyle/metrics","kyle/metrics/calibration_metrics","kyle/models","kyle/models/calibratable_model","kyle/models/resnet","kyle/sampling","kyle/sampling/fake_clf","kyle/transformations","kyle/util"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,nbsphinx:3,sphinx:56},filenames:["calibration_demo.ipynb","fake_classifiers.ipynb","getting-started.rst","index.rst","kyle/calibration.rst","kyle/calibration/calibration_methods.rst","kyle/calibration/calibration_methods/calibration_methods.rst","kyle/calibration/model_calibrator.rst","kyle/datasets.rst","kyle/evaluation.rst","kyle/evaluation/continuous.rst","kyle/evaluation/discrete.rst","kyle/index.rst","kyle/integrals.rst","kyle/metrics.rst","kyle/metrics/calibration_metrics.rst","kyle/models.rst","kyle/models/calibratable_model.rst","kyle/models/resnet.rst","kyle/sampling.rst","kyle/sampling/fake_clf.rst","kyle/transformations.rst","kyle/util.rst"],objects:{"":{kyle:[12,0,0,"-"]},"kyle.calibration":{calibration_methods:[5,0,0,"-"],model_calibrator:[7,0,0,"-"]},"kyle.calibration.calibration_methods":{calibration_methods:[6,0,0,"-"]},"kyle.calibration.calibration_methods.calibration_methods":{BaseCalibrationMethod:[6,1,1,""],BetaCalibration:[6,1,1,""],ClassWiseCalibration:[6,1,1,""],ConfidenceReducedCalibration:[6,1,1,""],HistogramBinning:[6,1,1,""],IsotonicRegression:[6,1,1,""],LogisticCalibration:[6,1,1,""],NetcalBasedCalibration:[6,1,1,""],TemperatureScaling:[6,1,1,""],get_binary_classification_data:[6,3,1,""],get_class_confs_labels:[6,3,1,""],get_reduced_confidences:[6,3,1,""]},"kyle.calibration.calibration_methods.calibration_methods.BaseCalibrationMethod":{fit:[6,2,1,""],get_calibrated_confidences:[6,2,1,""]},"kyle.calibration.calibration_methods.calibration_methods.ClassWiseCalibration":{fit:[6,2,1,""],get_calibrated_confidences:[6,2,1,""]},"kyle.calibration.calibration_methods.calibration_methods.ConfidenceReducedCalibration":{fit:[6,2,1,""],get_calibrated_confidences:[6,2,1,""]},"kyle.calibration.calibration_methods.calibration_methods.NetcalBasedCalibration":{fit:[6,2,1,""],get_calibrated_confidences:[6,2,1,""]},"kyle.calibration.model_calibrator":{ModelCalibrator:[7,1,1,""]},"kyle.calibration.model_calibrator.ModelCalibrator":{calibrate:[7,2,1,""]},"kyle.datasets":{get_cifar10_dataloader:[8,3,1,""],get_cifar10_dataset:[8,3,1,""],resnet_denormalize_transform:[8,3,1,""]},"kyle.evaluation":{continuous:[10,0,0,"-"],discrete:[11,0,0,"-"]},"kyle.evaluation.continuous":{compute_ECE:[10,3,1,""],compute_accuracy:[10,3,1,""],compute_expected_max:[10,3,1,""]},"kyle.evaluation.discrete":{EvalStats:[11,1,1,""]},"kyle.evaluation.discrete.EvalStats":{TOP_CLASS_LABEL:[11,4,1,""],accuracy:[11,2,1,""],average_calibration_error:[11,2,1,""],average_marginal_calibration_error:[11,2,1,""],class_wise_expected_calibration_error:[11,2,1,""],expected_calibration_error:[11,2,1,""],expected_confidence:[11,2,1,""],expected_marginal_calibration_error:[11,2,1,""],marginal_accuracy:[11,2,1,""],marginal_reliabilities:[11,2,1,""],max_calibration_error:[11,2,1,""],plot_confidence_distributions:[11,2,1,""],plot_reliability_curves:[11,2,1,""],set_bins:[11,2,1,""],top_class_reliabilities:[11,2,1,""]},"kyle.integrals":{Integrand:[13,1,1,""],dirichlet_exp_value:[13,3,1,""],get_argmax_region_char_function:[13,3,1,""],simplex_integral:[13,3,1,""],simplex_integral_fixed_comp:[13,3,1,""],simplex_integral_fixed_max:[13,3,1,""]},"kyle.metrics":{calibration_metrics:[15,0,0,"-"]},"kyle.metrics.calibration_metrics":{ACE:[15,1,1,""],BaseCalibrationError:[15,1,1,""],ECE:[15,1,1,""],MCE:[15,1,1,""],NetcalCalibrationError:[15,1,1,""]},"kyle.metrics.calibration_metrics.BaseCalibrationError":{compute:[15,2,1,""]},"kyle.models":{calibratable_model:[17,0,0,"-"],resnet:[18,0,0,"-"]},"kyle.models.calibratable_model":{CalibratableModel:[17,1,1,""],ClassifierProtocol:[17,1,1,""]},"kyle.models.calibratable_model.CalibratableModel":{calibrate:[17,2,1,""],fit:[17,2,1,""],predict:[17,2,1,""],predict_proba:[17,2,1,""]},"kyle.models.calibratable_model.ClassifierProtocol":{fit:[17,2,1,""],predict:[17,2,1,""],predict_proba:[17,2,1,""]},"kyle.models.resnet":{load_weights:[18,3,1,""],resnet20:[18,3,1,""],resnet56:[18,3,1,""]},"kyle.sampling":{fake_clf:[20,0,0,"-"]},"kyle.sampling.fake_clf":{DirichletFC:[20,1,1,""],FakeClassifier:[20,1,1,""],MultiDirichletFC:[20,1,1,""]},"kyle.sampling.fake_clf.DirichletFC":{alpha:[20,2,1,""],fit:[20,2,1,""],pdf:[20,2,1,""],sample_confidences:[20,2,1,""],set_alpha:[20,2,1,""]},"kyle.sampling.fake_clf.FakeClassifier":{get_sample_arrays:[20,2,1,""],sample_confidences:[20,2,1,""],set_simplex_automorphism:[20,2,1,""],simplex_automorphism:[20,2,1,""]},"kyle.sampling.fake_clf.MultiDirichletFC":{alpha:[20,2,1,""],distribution_weights:[20,2,1,""],fit:[20,2,1,""],get_parameters:[20,2,1,""],pdf:[20,2,1,""],sample_confidences:[20,2,1,""],set_alpha:[20,2,1,""],set_distribution_weights:[20,2,1,""],set_parameters:[20,2,1,""],set_sigma:[20,2,1,""],sigma:[20,2,1,""]},"kyle.transformations":{IdentitySimplexAut:[21,1,1,""],MaxComponentSimplexAut:[21,1,1,""],PowerLawSimplexAut:[21,1,1,""],RestrictedPowerSimplexAut:[21,1,1,""],SimplexAut:[21,1,1,""],SingleComponentSimplexAut:[21,1,1,""]},"kyle.transformations.SimplexAut":{transform:[21,2,1,""]},"kyle.util":{in_simplex:[22,3,1,""],safe_accuracy_score:[22,3,1,""],sample_index:[22,3,1,""]},kyle:{calibration:[4,0,0,"-"],datasets:[8,0,0,"-"],evaluation:[9,0,0,"-"],integrals:[13,0,0,"-"],metrics:[14,0,0,"-"],models:[16,0,0,"-"],sampling:[19,0,0,"-"],transformations:[21,0,0,"-"],util:[22,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","function","Python function"],"4":["py","attribute","Python attribute"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:function","4":"py:attribute"},terms:{"002019585186626581":1,"00955290612159993":0,"022424558162753988":0,"02273518399897774":0,"05897156242616253":1,"059167102365727586":1,"0669516487805154":0,"09711500702038803":1,"09934254907310103":1,"0993425490731012":1,"100":0,"1000":0,"10000":0,"100000":1,"10638368255948694":1,"150":1,"17369679110861524":0,"17529354007477305":1,"18322050911568274":1,"18603759557547142":0,"200":[0,1],"2000":0,"2019":10,"2919213278242735":1,"2926152262421096":1,"300000":1,"48624":1,"500":1,"5000":0,"500000":1,"582":0,"60376":1,"71953":1,"7937466666666667":1,"7979166666666667":1,"798884":1,"8738803675065833":1,"87686":1,"abstract":[0,6,20],"case":0,"char":13,"class":[0,1,6,7,10,11,13,15,17,20,21,22],"default":[0,11,20],"float":[13,20,21,22],"function":[10,13],"import":[0,1],"int":[1,6,11,13,15,20,21,22],"k\u00e4ngsepp":10,"new":0,"return":[0,1,10,11,13,20,22],"true":[0,1,11,13,20,21],"while":0,ACE:15,ECE:[0,1,10,15],ECEs:[1,10],For:[0,1,2,13],One:0,That:0,The:[0,3,11,13,20,21],Using:20,_multilayer_perceptron:0,a_i:1,abc:[6,15,20,21],about:[0,1],abov:0,abserr:10,acc_i:[1,11],accept:13,account:11,accur:0,accuraci:[0,1,11,22],accuracy_:0,accuracy_per_bin:11,accuracy_scor:0,add:1,adding:0,addit:21,after:0,again:0,agnost:3,akamast:18,all:[0,1,10,13,20,21],alpha:[1,13,20],alpha_0:1,alpha_bound:20,alpha_i:1,alpha_k:20,also:[0,11],although:11,analyt:3,ani:0,antipod:21,anyth:0,anywher:11,appli:21,applic:21,appropi:13,approxim:[0,1],area:13,arg:[6,13,17],argmax:[13,20,21],argument:13,around:[15,22],arrai:[1,11,20,21,22],ask:0,assign:0,assum:0,asymptot:[0,1],aut:20,automorph:[0,1,20,21],autoreload:1,averag:[0,10,15],average_calibration_error:11,average_marginal_calibration_error:11,awai:0,axi:0,b_k:0,bad:21,base:[6,7,11,13,15,17,20,21],basecalibrationerror:15,basecalibrationmethod:6,baseestim:6,basicconfig:1,becom:[0,13],been:11,befor:0,begin:0,being:[0,13],belong:0,below:1,best:20,beta:1,betacalibr:6,between:[0,11],beyond:10,big:0,bin:[0,1,11,15],binom:1,bool:[7,22],both:[0,1],bound:20,boundari:[13,21],boundary_offset:13,build:2,c_i:1,calcul:[0,1,10],calib:0,calibr:[3,6,7,10,11,12,15,17],calibrat:0,calibratable_model:[0,3,7,12,16],calibratablemodel:[0,7,17],calibrated_confid:0,calibrated_sampl:0,calibration_method:[0,3,4,12],calibration_method_factori:6,calibration_metr:[3,12,14],call:0,callabl:[13,21],can:[0,1,13],cancer:0,cannot:0,categor:20,cdot:1,center:21,certain:0,certainli:1,check:[21,22],check_io:[20,21],choic:22,cifar10:18,class_label:[0,11],class_wise_expected_calibration_error:11,classifi:[0,3,10,11,20,22],classifierprotocol:17,classwisecalibr:6,clear:[0,11],closer:0,code:18,com:18,compar:0,comparison:0,complet:[1,11],complex:13,compon:[13,21],comput:[0,3,10,11,13,15,20],compute_accuraci:[1,10],compute_ec:[1,10],compute_expected_max:[1,10],concept:0,concern:0,condit:10,conf:6,confid:[0,1,6,10,11,13,15,20],confidence_:0,confidencereducedcalibr:6,confirm:0,contain:[10,11],continu:[0,1,3,9,12],converg:[0,1],convergencewarn:0,convers:0,coord_sum:13,coordin:13,copi:[0,1],corner:20,correct:[0,22],correspond:[1,11,20,21],creat:0,curv:[0,11],data:[0,8],dataset:[0,3,12],decent:0,def:[0,1],defin:13,denot:0,depend:1,describ:11,detail:[0,10],develop:[0,2],differ:[0,1,11,18],difficulti:1,dim:11,dimens:[13,21],dimension:13,direct:21,directli:20,directori:2,dirichlet:[3,10,13,20],dirichlet_exp_valu:13,dirichlet_fc:[1,10],dirichletfc:[0,1,10,20],discret:[0,3,9,12],displai:11,display_weight:[1,11],distribut:[13,20],distribution_weight:20,doc:[2,15],doe:[0,1],don:[0,11],done:0,down:0,draw:20,due:[0,1,13],each:[0,10,11,13,20],earlier:0,ece:0,ece_approx:1,ece_i:1,effect:20,either:[1,11],element:13,elementwis:21,empir:0,empti:22,encourag:2,end:[0,1],enough:0,entri:[0,10,13,20],equal:[0,13,21],equat:0,equival:20,error:[0,11,13,15],essenti:22,estim:[0,20],eval_stat:[0,1],evalstat:[0,1,11],evalu:[0,1,3,11,12],everyth:0,exampl:0,execut:2,exist:11,expect:[0,1,11,13,15],expected_calibration_error:[1,11],expected_confid:[1,11],expected_marginal_calibration_error:11,explain:0,explan:1,explicitli:1,expon:[1,21],express:1,extend:13,extent:0,fact:0,fail:1,fake:[0,3,10,20],fake_clf:[0,1,3,10,12,19],fakeclassifi:20,fals:[7,8,11,20],fare:0,feel:21,filho:10,finit:0,first:[1,10,13,20],fit:[0,6,7,17,20],fix:[0,13,21],flach:10,foral:0,form:20,formal:0,frac:[0,1],from:[0,1,2,18,20,21],full:[0,10,13],further:[0,10,15],gener:[0,6],get:[0,3,20],get_argmax_region_char_funct:13,get_binary_classification_data:6,get_calibrated_confid:6,get_cifar10_dataload:8,get_cifar10_dataset:8,get_class_confs_label:6,get_paramet:20,get_reduced_confid:6,get_sample_arrai:[0,1,20],github:18,given:[0,11],goe:[0,1],good:0,great:0,ground:[0,20,22],ground_truth:[0,6,15],guess:20,guid:3,h_i:1,hardest:1,has:[0,18,20],hasn:0,have:[0,1,2,11,13,22],healthi:0,help:1,here:[0,1],hidden_layer_s:0,hide:0,highest:0,histogram:11,histogrambin:6,hold:0,home:0,homogen:11,how:[0,11],howev:[0,1],http:18,idea:21,ident:20,identitysimplexaut:21,illustr:0,imagenet:18,imagin:0,implement:[15,18],improv:0,in_simplex:22,includ:11,increas:0,inde:0,independ:13,index:[3,22],indic:[13,22],individu:20,infer:0,infin:20,info:1,inform:0,initi:20,initial_alpha:20,initial_paramet:20,input:[0,13,21,22],instal:2,instanc:0,instead:0,int_:1,integ:[11,21],integr:[3,10,12],integrand:13,interpret:[0,11],interv:[20,21],intuit:[0,21],involv:13,isotonicregress:6,iter:0,its:0,itself:[0,21],job:0,kind:0,know:11,known:0,kull:10,kwarg:[10,13,15,20,22],kwd:[6,13,17],kyle:[0,1,6,7,10,13,15,17,18,20,21],label:[0,6,11,22],largest:13,learn:0,leav:0,left:1,length:[11,21],lessapprox:1,let:0,level:1,lib:0,librari:2,like:13,likeihood:20,likelihood:20,limit:1,line:0,list:[10,20],load_ext:1,load_weight:18,log:1,logisticcalibr:6,lower:20,lower_bound:20,machin:0,made:11,mai:0,mainli:13,make:0,make_classif:0,mani:[0,1,11],manifold:21,map:21,marginal_accuraci:11,marginal_reli:11,marginalis:13,mask:[0,1],master:2,math:1,matplotlib:1,max_calibration_error:11,maxcompon:1,maxcomponentsimplexaut:[0,1,21],maximum:[0,13,15,20],mayb:21,mce:15,mean:[0,1,11,21],measur:0,medium:1,member:11,mention:0,merg:2,method:0,metric:[0,3,11,12,15],might:0,minim:20,mis:0,miscalibr:0,mle:20,mlpclassifi:0,model:[1,3,7,12,17,18],model_accuraci:0,model_calibr:[3,4,12],model_select:0,modelcalibr:[0,7],modul:3,more:[0,21],mostli:1,much:0,multi:20,multiclass:10,multidirichletfc:20,multipl:22,must:21,n_class:[0,1,11,20,22],n_featur:0,n_indic:22,n_inform:0,n_redund:0,n_sampl:[0,1,11,20,22],name:[0,11],natur:0,nbsphinx:1,ndarrai:[0,1,6,7,11,15,17,20,21,22],need:0,netcal:15,netcal_metr:15,netcalbasedcalibr:6,netcalcalibrationerror:15,network:0,neural:0,neural_network:0,new_fig:11,nieto:10,non:13,none:[7,20,21,22],normal:[0,21],note:[1,13],notic:0,notion:0,now:0,nquad:[10,13],num_class:[0,10,13,20,21,22],num_members_per_bin:11,num_sampl:20,number:[11,13,18,21,22],numer:[1,13],numpi:[0,1,6,7,11,15,17,20,21,22],object:[7,11],obtain:[0,10],okai:0,onc:0,one:[1,13,20],ones:1,onli:[0,11,18,20],oper:0,opt:1,optim:[0,20],optimizeresult:20,option:20,order:2,other:13,our:[0,11],out:[0,13],output:[0,10,21],over:[0,13],overconfid:1,overestim:1,overestimating_max:[0,1],p_m:0,packag:[0,2],page:3,paper:11,param:[11,20],paramet:[10,11,13,18,20,21,22],parameter_bound:20,part:1,pass:[0,10,13,20],path:8,patholog:1,patient:0,pdf:[13,20],peak:1,perello:10,perfectli:0,perform:[0,2,13],person:0,piec:0,plot:[0,1,11],plot_confidence_distribut:11,plot_reliability_curv:[0,1,11],plt:1,posit:[0,20],possibl:[0,13],post:0,post_calibration_ec:0,potenti:1,power:21,powerlawsimplexaut:[1,21],pre:0,pre_calibration_ec:0,predict:[0,1,10,11,17,20,22],predict_proba:[0,17],pretti:[0,1],prevent:13,previou:0,print:1,probabilist:11,probabl:[0,1,10,11,20,22],process:0,proper:18,properti:[0,3,20],protocol:[13,17],provid:[0,20,21,22],pyplot:1,python3:0,python:2,pytorch:18,pytorch_resnet_cifar10:18,quad:[0,10],quantiti:[10,11],quit:0,random:22,random_st:0,rang:[0,21],rather:[0,1],reach:0,read:15,readi:0,reasong:0,refer:[10,15],regard:1,regim:1,rel:11,relev:1,reliabl:[0,11],remain:21,remedi:0,repres:13,requir:0,resnet20:18,resnet56:18,resnet:[3,12,16],resnet_denormalize_transform:8,restrict:20,restrictedpoweraut:1,restrictedpowersimplexaut:[1,21],result:[0,3,10,20,21],right:[0,1],rightarrow:1,root:2,roughli:1,run:2,runner:0,safe_accuracy_scor:22,sai:0,sake:11,same:[0,1],sampl:[0,1,3,10,12,20,22],sample_confid:20,sample_index:22,sampler:0,scale:[0,10,11],scipi:[10,13,20],score:0,search:3,second:1,see:[0,1,10],seem:[0,1],seen:0,select:[11,13],selected_class:13,self:20,sensit:1,separ:[10,20],sequenc:[11,13,20,21,22],set:[0,1,13,20],set_alpha:20,set_bin:[1,11],set_distribution_weight:20,set_paramet:20,set_sigma:20,set_simplex_automorph:[1,20],setup:2,sever:2,shape:[11,20,22],sharp:1,shift:[0,21],shifted_sampl:0,shiftingsimplexautomorph:0,should:[0,2,13,21],side:1,sigma:20,similar:0,simpl:0,simplex:[1,13,20,21],simplex_automorph:[0,20],simplex_integr:13,simplex_integral_fixed_comp:13,simplex_integral_fixed_max:13,simplexaut:[20,21],simplfied_fit:20,simpli:0,simplified_fit:20,simul:0,singl:[21,22],singlecomponentsimplexaut:21,singular:13,site:0,situat:0,size:0,sklearn:[0,6,22],slice:0,slowli:1,some:[1,21],someth:0,somewher:11,song:10,sort:[1,11],sourc:[6,7,8,10,11,13,15,17,18,20,21,22],space:[0,13],standard:13,start:[1,3],statist:11,stochast:0,store:22,stori:0,str:[8,11,18],strongli:0,subject:0,subsequ:10,subset:[13,20],successfulli:[0,2],suffici:[0,1],suggest:0,sum:[13,20,21],sum_:0,suppos:0,systemat:0,take:[0,1,11,13,21],taken:18,talk:0,techniqu:0,tell:0,temperatur:[0,10],temperaturesc:[0,6],tensor:8,term:11,test:[0,2],test_siz:0,than:21,thei:[0,1,13],them:11,theoret:[1,10],theoretical_acc:1,theoretical_ec:1,thi:[0,1,2,11,13,21,22],thing:1,think:0,through:1,tild:1,time:[0,1],top:[1,11],top_class:11,top_class_label:[1,11],top_class_reli:11,torch:8,toward:21,tox:[0,2],train:[0,8],train_test_split:0,transform:[0,1,3,12,20],truth:[0,20,22],tupl:[11,20],tutori:3,two:[0,1,11],type:[6,13,17],typic:0,unbound:20,uncalibr:0,uncalibrated_confid:0,uncalibrated_sampl:0,underestim:1,unfortun:0,union:[11,22],unit:[13,21],unnatur:21,unseen:0,upper:20,upper_bound:20,usag:2,use:[0,1,21],used:[13,20],useful:13,uses:20,using:[0,13,20],util:[3,12],valid:0,valu:[0,1,13,20],variabl:[13,20],varianc:[1,20],variou:0,vec:1,vector:[0,10,13,21,22],veri:[1,11],verifi:0,version:22,via:[0,20],visual:0,wai:0,wait:0,want:0,warn:0,weight:[0,1,11,20],weights_path:18,well:10,what:[3,11],when:[0,1],where:[0,20],wherea:[0,21],whether:[0,22],which:[0,13,18,20,21],who:0,widehat:0,wild:11,without:2,wonder:0,work:[0,2],would:0,wrap:15,wrapper:22,wrong:0,x_calibr:[0,7],x_comp:13,x_fit:[0,7],x_max:13,x_n:13,x_test:0,x_train:0,y_calibr:[0,7],y_fit:[0,7],y_pred:[0,22],y_test:0,y_train:0,y_true:[11,22],yet:[0,11],you:[0,2],zero:22},titles:["What is calibration?","Dirichlet fake classifiers","Getting started","kyle library and game","calibration","calibration_methods","calibration_methods","model_calibrator","datasets","evaluation","continuous","discrete","Library Modules","integrals","metrics","calibration_metrics","models","calibratable_model","resnet","sampling","fake_clf","transformations","util"],titleterms:{The:1,agnost:0,analyt:1,calibr:[0,1,4],calibratable_model:17,calibration_method:[5,6],calibration_metr:15,classifi:1,comput:1,continu:10,dataset:8,dirichlet:1,discret:11,evalu:9,fake:1,fake_clf:20,game:[1,3],get:2,indic:3,integr:[1,13],kyle:3,librari:[3,12],metric:14,model:[0,16],model_calibr:7,modul:12,properti:1,resnet:18,result:1,sampl:19,start:2,tabl:3,transform:21,util:22,what:0}})